## 최소한의 코드에만 트랜잭션 적용해라

### 예제

1. 처리 시작
    1. `데이터 베이스 커넥션 생성`
    2. `트랜잭션 시작`
2. 사용자의 로그인 여부 확인
3. 사용자의 글쓰기 내용의 오류 여부 확인
4. 첨부로 업로드된 파일 확인 및 저장
5. 사용자의 입력 내용을 DBMS에 저장
6. 첨부 파일 정보를 DBMS에 저장
7. 저장된 내용 또는 기타 정보를 DBMS에서 조회
8. 게시물 등록에 대한 알림 메일 발송
9. 알림 메일 발송 이력을 DBMS에 저장
    1. `트랜잭션 종료 (Commit)`
    2. `데이터베이스 커넥션 반납`
10. 처리 완료

### 좋지 않은 부분 확인
> 보통 개발자들은 맨처음 **1번에서 트랜잭션을 시작하고 맨 마지막에 트랜잭션을 종료**한다.
- `제한적인 커넥션` : 2,3,4번은 굳이 트랜잭션에 포함시킬 필요가 없다
    - 이유? 커넥션이 제한적이기 때문에 소유하는 시간이 길어질수록 사용 가능 여유 커넥션이 줄어든다
- `외부 네트워크 제거` : 8번과 같이 메일 전송이나 FTP 파일 전송 작업 또는 네트워크를 통해 원격 서버와 통신하는 등과 같은 작업은 어떻게 해서든 DBMS의 트랜잭션 내에서 제거하는 것이 좋다. 프로그램이 실행되는 동안 메일 서버와 통신할 수 없는 상황이 발생한다면 웹 서버뿐 아니라 DBMS 서버까지 위험해지는 상황이 발생할 것
- `트랜잭션 별도로 묶기`  : 7번은 단순 확인 및 조회 작업이기 때문에 트랜잭션에 포함될 필요가 없다. 또한 9번은 조금 성격이 다르기 때문에 이전 트랜잭션(5번, 6번)과 함께 묶지 않아도 무방하다.

#### 참고
+ 위 상황들은 모두 업무 요건에 따라 달라질 수 있다.
